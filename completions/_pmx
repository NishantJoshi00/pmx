#compdef pmx

_pmx() {
    local -a commands
    commands=(
        'set-claude-profile:Set a Claude profile'
        'reset-claude-profile:Reset the current Claude profile'
        'set-codex-profile:Set a Codex profile'
        'reset-codex-profile:Reset the current Codex profile'
        'list:List available profiles'
        'copy-profile:Copy profile contents to clipboard'
        'completion:Generate shell completions'
        'help:Print help message'
    )
    
    if (( CURRENT == 2 )); then
        _describe 'command' commands
    elif (( CURRENT == 3 )); then
        case "$words[2]" in
            set-claude-profile|set-codex-profile|copy-profile)
                local -a profiles
                profiles=(${(f)"$(pmx list 2>/dev/null)"})
                _describe 'profile' profiles
                ;;
            completion)
                _values 'shell' 'zsh'
                ;;
        esac
    fi
}

compdef _pmx pmx
